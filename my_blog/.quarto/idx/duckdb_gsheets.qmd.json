{"title":"Level Up Your Data Analysis from Your Command Line","markdown":{"headingText":"Level Up Your Data Analysis from Your Command Line","containsRefs":false,"markdown":"*Connecting DuckDB to Google Sheets!*   \n*Apr, 2025*\n\n<!-- use 03 spaces among paragraphs to create a new line-->\n**Jesus L. Monroy**   \n*Economist & Data Scientist*\n\n![](https://www.arecadata.com/content/images/size/w960/2024/01/Group-6--1-.png)\nSource: https://www.arecadata.com/sql-for-google-sheets-with-duckdb\n\n# Introduction\n\nTired of downloading CSVs and juggling spreadsheets for your data analysis? Want the power of a lightning-fast, in-process analytical database without the complex setup?\nThen it's time to unlock the magic of connecting DuckDB directly to your Google Sheets!\n\nDuckDB is a phenomenal open-source analytical data management system.\nIt's incredibly fast, lightweight, and can run directly within your Python environment (or other languages).\nCombining its power with the accessibility and collaborative nature of Google Sheets opens up a world of possibilities for streamlined and efficient data analysis.\n\n# DuckDB & Google Sheets: A Game Changer\n\n**Real-time Data Access**\n\nNo more manual exporting and importing! DuckDB can directly query the data in your Google Sheet, ensuring you're always working with the latest information.\n\n**Leverage DuckDB's Analytical Power**\n\nPerform complex SQL queries, joins, aggregations, and window functions on your Google Sheets data with DuckDB's blazing-fast engine. This goes far beyond the basic formulas available in spreadsheets.\n\n**Simplified Data Pipelines**\n\nAutomate your analysis workflows by directly pulling data from Google Sheets into your DuckDB scripts. This reduces manual steps and potential errors.\n\n**Collaboration & Analysis in One Place**\n\nMaintain the collaborative benefits of Google Sheets for data collection and sharing, while empowering analysts with DuckDB's robust analytical capabilities.\n\n**Scalability Beyond Spreadsheets**\n\nHandle larger datasets more efficiently than you could within Google Sheets alone. DuckDB can process significantly more data with greater speed.\n\n**Reproducible Analysis**\n\nYour analysis code in DuckDB becomes a clear and reproducible record of how you processed the data from your Google Sheet.\n\n# How to Connect DuckDB to Google Sheets\n*Using CLI*\n\n- Install duckdb to your terminal\n\n```bash\ncurl https://install.duckdb.org | sh\n```\n\n- Open duckdb in your terminal\n\n```bash\nduckdb\n```\n\n![](https://media.datacamp.com/cms/google/ad_4nxfpnxgiox9paod5zagibaizs8fyfrqgpqcljyup0lcibel52_ghhh4bi-q-f_jccjx46v4tnelm87elkmybxwhka6-ogr90wfquao_kzxz_ndi0pxulkoydo6htczz-s3jb2l8ns4ofejnwbdlwm4aila0e.png)\n\n- Install gsheets\n\n```sql\ninstall gsheets from community;\nload gsheets;\n```\n\n- Obtain gsheets url\n\n```markdown\nhttps://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit#gid=YOUR_TAB_ID\n```\n\nYou will just need: `YOUR_SHEET_ID`\n\n- Connect to gsheets\n\n```bash\ncreate secret (type gsheet, provider oauth);\n```\n\n![](https://duckdb.org/images/blog/gsheets_oauth_browser_screenshot.png)\n\n<br>\n\n- Run your query\n\n```sql\nSELECT current_job_title,\n    round(avg(try_cast(base_salary as int))) as avg_salary\nFROM read_gsheet('YOUR_SHEET_ID', sheet='titles')\nWHERE currency = 'USD'\nAND state = 'Texas'\nGROUP BY current_job_title\nORDER BY avg_salary DESC;\n```\n\n![](https://www.arecadata.com/content/images/size/w1000/2024/01/Screenshot-2024-01-17-at-09.31.50.png)\nSource: https://www.arecadata.com/sql-for-google-sheets-with-duckdb\n\n# Conclusions\n\nConnecting DuckDB to Google Sheets is a powerful and convenient way to enhance data analysis workflows. \nIt brings the speed and analytical capabilities of an in-process OLAP database to the familiar environment of Google Sheets.\nWhile there are some setup and authentication considerations, the benefits of using SQL for spreadsheet data and the ability to read and write data directly make this integration a valuable tool for data professionals and anyone working with data in Google Sheets.\n\n# References\n\n- Duckdb (n.d.) [DuckDB GSheets Tutorial](https://duckdb-gsheets.com/)\n- Palma, D (2024) [SQL for Google Sheets with DuckDB\nAnalyze data in Google Sheets using SQL with DuckDB\n](https://www.arecadata.com/sql-for-google-sheets-with-duckdb). Areca Data. Retrieved from website.\n\n# Contact\n\n**Jesus L. Monroy**   \n*Economist & Data Scientist*\n\n[Linkedin](https://www.linkedin.com/in/j3sus-lm) | \n[Medium](https://medium.com/@jesuslm) | \n[Twitter](https://x.com/j3suslm)\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"duckdb_gsheets.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.24","page-layout":"full","grid":{"sidebar-width":"250px","body-width":"800px","margin-width":"200px","gutter-width":"1em"},"theme":["flatly"],"toc-title":"Table of Contents","toc-expand":3},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}